<div class="content">
    <div id="main_view"></div>
    <div id="example_code"></div>
</div>

<!--CODE-->


<div id="req-id" style="width: 400px; height: 200px;"></div>
<div id="res-id" style="position:relative;left:500px;top:-200px;width:400px;height:200px"></div>
<button class="w2ui-btn" style="position:relative;left:300px;top:-180px;" onclick="json_get()">GET</button>
<button class="w2ui-btn" style="position:relative;left:440px;top:-180px;" onclick="json_set()">SET</button>
<div id="rsp-id" style="position:relative;left:0px;top:-160px;width:900px;height:400px"></div>

<!--CODE-->
<script>
$(function () {

    const options = {
      mode: 'code'
    }

    console.log( w2ui['sidebar1'].selected);

    const req_ele = document.getElementById("req-id")
    const req_edit = new JSONEditor(req_ele, options)
    // set json
    const req_init = {
        "id": "GSF_ID_CODEC_VENC",
        "args":"G0C0S0",
        "data":{}
    }
    req_edit.set(req_init);


    const res_ele = document.getElementById("res-id")
    const res_edit = new JSONEditor(res_ele, options)
    // set json
    const res_init = {
    	"code":	0
    }
    res_edit.set(res_init);


    const rsp_ele = document.getElementById("rsp-id")
    const rsp_edit = new JSONEditor(rsp_ele, options)
    // set json
    const rsp_init = [{
    	"type":	0,
    	"width":	1920,
    	"height":	1080,
    	"gop":	50,
    	"flow":	1,
    	"bitrate":	4000,
    	"profile":	0,
    	"qp":	51
    }]
    rsp_edit.set(rsp_init);

    // get json
    //const updatedJson = req_edit.get();

});

function json_get(){
  
    var input = document.getElementById('req-id')
		//nanomsg
		// Milliseconds between reconnects.
		nanomsg.reconnectTime = 10 * 1000;
		// Show some debug logging in the console.
		nanomsg.debug = true;
		// Receives ArrayBuffer objects instead of strings. Default is `false`.
		nanomsg.receiveArrayBuffer = false;
  
		const sock = new nanomsg.Socket(nanomsg.REQ);
		// const sock = new nanomsg.Socket(nanomsg.PAIR);
		sock.connect('ws://' + window.location.hostname + ':7790')
		// old school more streamy approach

		sock.on('data', function (msg) {
		  //console.log('got =>', msg);
		  document.getElementById('rsp-id').value = msg /* <-- an improvement from FileReader :) */
		});
  
    sock.send(input.value)
}


function json_set(){
  
    var input = document.getElementById('rsp-id')

		//nanomsg
		// Milliseconds between reconnects.
		nanomsg.reconnectTime = 10 * 1000;
		// Show some debug logging in the console.
		nanomsg.debug = true;
		// Receives ArrayBuffer objects instead of strings. Default is `false`.
		nanomsg.receiveArrayBuffer = false;
  
		const sock = new nanomsg.Socket(nanomsg.REQ);
		// const sock = new nanomsg.Socket(nanomsg.PAIR);
		sock.connect('ws://' + window.location.hostname + ':7790')
		// old school more streamy approach

		sock.on('data', function (msg) {
		  //console.log('got =>', msg);
		  document.getElementById('res-id').value = msg /* <-- an improvement from FileReader :) */
		});
  
    sock.send(input.value)
}



</script>
